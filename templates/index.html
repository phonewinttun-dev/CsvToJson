<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>CSV to JSON Converter</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

        <style>
            :root {
                --bs-body-bg: #121212; /* Dark background */
                --bs-body-color: #f0f0f0; /* Light text */
                --bs-secondary-color: #a0a0a0; /* Muted text */
                --bs-border-color: #333333; /* Dark border */
                --bs-card-bg: #1e1e1e; /* Slightly lighter card background */
                --bs-primary: #ffffff; /* Primary color is white for buttons/highlights */
                --bs-primary-rgb: 255, 255, 255;
            }

            body {
                background: var(--bs-body-bg);
                color: var(--bs-body-color);
            }

            .navbar {
                background-color: var(--bs-card-bg) !important; /* Darker navbar */
                border-bottom: 1px solid var(--bs-border-color) !important;
            }

            .navbar-brand {
                color: var(--bs-body-color) !important;
            }

            .text-muted {
                color: var(--bs-secondary-color) !important;
            }

            .card {
                background-color: var(--bs-card-bg);
                border: 1px solid var(--bs-border-color);
            }
            
            .card-body {
                color: var(--bs-body-color);
            }

            .drop-zone {
                border: 2px dashed var(--bs-border-color);
                border-radius: .5rem;
                padding: 2.5rem; /* Increased padding for emphasis */
                text-align: center;
                transition: background .15s, border-color .15s;
                background: #1e1e1e;
            }
            
            .drop-zone.dragover {
                background: #282828; /* Subtle change on dragover */
                border-color: var(--bs-primary); /* White border on hover */
            }

            /* Overriding Bootstrap Button styles for B&W theme */
            .btn-primary {
                --bs-btn-color: #000;
                --bs-btn-bg: var(--bs-primary);
                --bs-btn-border-color: var(--bs-primary);
                --bs-btn-hover-color: #121212;
                --bs-btn-hover-bg: #ccc;
                --bs-btn-hover-border-color: #ccc;
                --bs-btn-active-bg: #aaa;
                --bs-btn-active-border-color: #aaa;
                --bs-btn-disabled-color: #a0a0a0;
                --bs-btn-disabled-bg: #333333;
                --bs-btn-disabled-border-color: #333333;
                font-weight: 600;
            }

            .btn-outline-primary {
                --bs-btn-color: var(--bs-primary);
                --bs-btn-border-color: var(--bs-primary);
                --bs-btn-hover-color: #000;
                --bs-btn-hover-bg: var(--bs-primary);
                --bs-btn-hover-border-color: var(--bs-primary);
                font-weight: 600;
            }

            /* Adjusting the upload icon color to match the theme */
            .drop-zone svg path {
                stroke: var(--bs-secondary-color);
            }

            .drop-zone.dragover svg path {
                stroke: var(--bs-primary);
            }

            /* File Info text color adjustment */
            #fileInfo {
                color: var(--bs-body-color) !important;
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg border-bottom">
            <div class="container">
                <a class="navbar-brand fw-bold" href="#">CSV → JSON</a>
                <div class="ms-auto text-muted small">Fast, simple conversion</div>
            </div>
        </nav>

        <main class="container py-5">
            <div class="row justify-content-center">
                <div class="col-lg-7">
                    <div class="card shadow-lg border-0"> <div class="card-body p-4">
                            <div class="d-flex align-items-start">
                                <div class="me-3">
                                    <h2 class="h5 mb-1 text-uppercase fw-light">CSV to JSON Converter</h2>
                                    <p class="text-muted mb-0 small">Upload a CSV file and download the converted JSON.</p>
                                </div>
                            </div>

                            <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data" class="mt-4">
                                <div id="dropZone" class="drop-zone mb-4">
                                    <div class="mb-2">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" class="mb-2">
                                            <path d="M12 3v9" stroke="#6c7577" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M21 15v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2" stroke="#6c7577" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M7 11 12 6l5 5" stroke="#6c7577" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <div class="mb-2">
                                        <strong class="text-white">Drag & drop a CSV here</strong>
                                    </div>
                                    <div class="text-muted small">or click to browse — UTF-8 encoded CSV recommended</div>
                                    <input id="fileInput" name="file" type="file" accept=".csv" class="form-control visually-hidden" required>
                                </div>

                                <div class="d-flex align-items-center gap-2 mb-3">
                                    <div id="fileInfo" class="text-truncate">No file selected</div>
                                    <div class="ms-auto">
                                        <button id="browseBtn" type="button" class="btn btn-outline-primary btn-sm">BROWSE</button>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <button id="convertBtn" type="submit" class="btn btn-primary w-100" disabled>
                                        <span id="btnSpinner" class="spinner-border spinner-border-sm me-2 d-none" role="status" aria-hidden="true"></span>
                                        CONVERT TO JSON
                                    </button>
                                </div>

                                <div id="alertPlaceholder" aria-live="polite"></div>
                            </form>

                            <div class="mt-4 pt-3 border-top small" style="border-color: var(--bs-border-color) !important;">
                                <span class="text-muted">Tip:</span> The converter will keep headers as JSON keys. Your data is processed securely and is not stored.
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-3 small text-muted">A simple utility</div>
                </div>
            </div>
        </main>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const fileInfo = document.getElementById('fileInfo');
            const convertBtn = document.getElementById('convertBtn');
            const btnSpinner = document.getElementById('btnSpinner');
            const alertPlaceholder = document.getElementById('alertPlaceholder');

            function setFile(file) {
                if (!file) {
                    fileInfo.textContent = 'No file selected';
                    convertBtn.disabled = true;
                    return;
                }
                fileInfo.innerHTML = `<span class="file-name text-white">${file.name}</span> • ${Math.round(file.size / 1024)} KB`;
                convertBtn.disabled = false;
            }

            browseBtn.addEventListener('click', () => fileInput.click());

            fileInput.addEventListener('change', (e) => {
                setFile(e.target.files[0]);
            });

            // Drag & drop
            ['dragenter', 'dragover'].forEach(evt => {
                dropZone.addEventListener(evt, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropZone.classList.add('dragover');
                });
            });
            ['dragleave', 'drop', 'dragend'].forEach(evt => {
                dropZone.addEventListener(evt, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropZone.classList.remove('dragover');
                });
            });
            dropZone.addEventListener('drop', (e) => {
                const files = e.dataTransfer.files;
                if (files.length) {
                    fileInput.files = files;
                    setFile(files[0]);
                }
            });
            dropZone.addEventListener('click', () => fileInput.click());

            // // Show spinner on submit (uncommented for functionality)
            // document.getElementById('uploadForm').addEventListener('submit', (e) => {
            //     convertBtn.disabled = true;
            //     btnSpinner.classList.remove('d-none');
            // });

            // Initial file state setup on load
            setFile(fileInput.files[0]);
        </script>
    </body>
</html>